# 论文摘要：Polynomial Factorization in Maple 2019

> Monagan & Tuncer, MC 2019 (Extended Abstract)
> PDF: `MC2019-MonaganTuncer.pdf`
> 角色：**Maple 2019 MTSHL 集成报告**，确认 MTSHL 为默认算法，提供两组基准数据

---

## 主题

Maple 2019 的新多变量多项式因式分解算法综述。MTSHL 作为默认算法取代了 Wang 的算法。

---

## Maple 2019 变更概要

| 项目 | Maple 2019 之前 | Maple 2019 |
|------|----------------|-----------|
| 默认多变量因式分解算法 | Wang EEZ（Paul Wang 1978，Keith Geddes 实现） | **MTSHL**（Monagan-Tuncer，2018 年集成） |
| Wang 算法 | 默认 | 仍可用：`factor(a, method="Wang")` |
| 复杂度 | 稀疏情形指数（n 变量数） | 随机多项式时间 |
| 集成方式 | - | Baris Tuncer 在 MITACS 实习期间集成（2018 年初） |

**参考文献链**：CASC 2016 [3] → CASC 2018 [4] → JSC 2020 [5]

---

## 核心算法概述

MTSHL 的核心观察（MC 2019 的描述）：

```
fj = Σ σi(xj - αj)^i
    ↓
Supp(σi) ⊇ Supp(σi+1)  （以高概率，αj 随机选取时）
```

利用 Supp(σi-1) 作为 σi 的支撑骨架，构造 tj × tj Vandermonde 方程组，求解代价 O(tj²)。由于因子稀疏，tj << 全稠密，这是性能提升的根本原因。

---

## 性能基准 1：稀疏随机多因子（Table 1）

**实验设置**：
```maple
kernelopts(numcpus=1); t := 100; d := 15;
# a = f * g，每个因子 100 项，最高次 d，系数 ∈ [-10^6, 10^6]
# 测试 n = 5..14 变量
```

| n | Wang (MDP%) | MTSHL |
|---|------------|-------|
| 5 | 4.87s (89.4%) | 0.509s |
| 6 | 8.67s (85.8%) | 0.589s |
| 7 | 6.77s (91.2%) | 0.616s |
| 8 | 35.04s (94.7%) | 0.718s |
| 9 | 40.33s (99.6%) | 0.788s |
| 10 | 65.55s (98.0%) | 0.911s |
| 11 | 154.8s (98.0%) | 0.989s |
| 12 | 169.8s (99.0%) | 1.78s |
| 13 | 163.8s (96.5%) | 1.16s |
| 14 | 603.6s (98.7%) | 2.37s |

**关键发现**：
- Wang 中 MDP 求解占 85–99%，随 n 增大趋近 100%（指数爆炸）
- MTSHL 时间几乎与 n 线性增长（理论：O(n) in n）
- 最大加速比：n=14 时 **255x**（603.6s → 2.37s）

---

## 性能基准 2：稠密循环矩阵行列式（Table 2）

**实验设置**：`det(Cn)`，n×n 循环矩阵，因子 **稠密**。

```maple
# det(Cn(xn=1)) 因式分解
kernelopts(numcpus=1);
for n from 6 to 14 do ...
```

| n | #det | deg(fi) | max#fi | MTSHL | Wang | Magma |
|---|------|---------|--------|-------|------|-------|
| 8 | 810 | 1,1,2,4 | 86 | 0.140s | 0.096s | 0.12s |
| 9 | 2704 | 1,2,6 | 1005 | 0.465s | 0.253s | 1.02s |
| 10 | 7492 | 1,1,4,4 | 715 | 3.03s | 1.020s | 10.97s |
| 11 | 32066 | 1,10 | 184756 | 1.33s | 12.43s | 142.85s |
| 12 | 86500 | 1,1,2,2,2,4 | 621 | 4.97s | 20.51s | (65%) 7575.14s |
| 13 | 400024 | 1,12 | 2704156 | 10.24s | 212.40s | (88%) 30,871.9s |
| 14 | 1366500 | 1,1,6,6 | 27132 | 666.0s | 1364.4s | > 10^6s |

**关键发现**：
- n=8,9,10：Wang 快于 MTSHL（稠密因子，MTSHL 无内在优势）
- **n≥11**：Wang 开始大幅落后（MDP 计算在 n 变量时仍呈指数增长，即便因子稠密）
- 结论：MTSHL 对**任意**多变量多项式（包括稠密情形）在高 n 时均优于 Wang

---

## 重要结论

1. **MTSHL 不仅适用于稀疏情形**：即使因子稠密（如循环矩阵），MTSHL 在 n 较大时也优于 Wang，因为 Wang 的 MDP 求解在 n 上是指数的，而 MTSHL 是线性的

2. **MDP 是瓶颈**：无论 Wang 还是 MTSHL，85–99% 的时间在 MDP 求解；MTSHL 的 MDP 求解器（稀疏插值）对稀疏 MDP 解远快于 Wang 的递归求解器

3. **Zippel 的比较**（文中提及）：MTSHL 经实验验证快于 Kaltofen 和 Zippel 的稀疏 Hensel 提升

---

## 对 CLPoly 的意义

- **架构确认**：MTSHL 是工业级 CAS 的默认多变量因式分解算法；CLPoly 应以此为目标
- **Table 1** 数据是 CLPoly Phase 2 实现后的性能参考基准
- **Table 2** 修正了之前的假设：CLPoly 架构文档中"稠密情形优先 Wang"的策略对 n≥11 时不成立；MTSHL 对任意密度均有优势
- **方法选项**：CLPoly 可以通过 `method` 参数暴露 Wang 和 MTSHL 两种路径
