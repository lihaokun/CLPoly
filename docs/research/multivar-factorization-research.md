# è°ƒç ”æŠ¥å‘Šï¼šå¤šå˜é‡å› å¼åˆ†è§£æ€§èƒ½ä¼˜åŒ–

> è°ƒç ”æ—¥æœŸï¼š2026-02-23
> ç›®æ ‡ï¼šå®šä½ CLPoly å¤šå˜é‡å› å¼åˆ†è§£ä¸ FLINT 7000x æ€§èƒ½å·®è·çš„æ ¹å› ï¼Œç¡®å®šä¼˜åŒ–æ–¹å‘
> å‚è€ƒå®ç°ï¼šFLINT `fmpz_mpoly_factor.c`ï¼ˆ`factor_zippel.c` / `factor_zassenhaus.c`ï¼‰ï¼›Maple 2019 MTSHL
> å½“å‰ä»£ç ï¼š`clpoly/polynomial_factorize_wang.hh`ï¼ˆ`__wang_core`ã€`__multivar_hensel_lift`ã€`__multivar_diophantine`ï¼‰

---

## 1. æ€§èƒ½å·®è·å®æµ‹æ•°æ®

æ¥æºï¼š`benchmarks/2026-02-23-043839.txt`ï¼ˆrelease build `-O3 -DNDEBUG`ï¼‰

### 1.1 å°è§„æ¨¡ç”¨ä¾‹ï¼ˆCLPoly ä¸ FLINT æ¥è¿‘ï¼‰

| ç”¨ä¾‹ | CLPoly | FLINT | æ¯”ç‡ |
|------|--------|-------|------|
| factor xÂ²-yÂ² | 0.038ms | 0.023ms | 1.67x |
| factor bivar deg3*deg3 | 0.293ms | 0.160ms | 1.83x |
| factor bivar deg5*deg5 | 0.834ms | 0.325ms | 2.56x |
| factor trivar known | 0.130ms | 0.109ms | 1.20x |
| factor SymPy f_1 (3var) | 0.645ms | 0.471ms | 1.37x |

**ç»“è®º**ï¼šå°è§„æ¨¡ï¼ˆä½å› å­æ•°ï¼‰å¤šå˜é‡å› å¼åˆ†è§£ï¼ŒCLPoly ä¸ FLINT å·®è·ä»… 1.2xâ€“2.6xï¼Œå±æ•°æ®ç»“æ„å¼€é”€ï¼ˆç¨€ç– pair-vector vs å¯†é›†æ•°ç»„ï¼‰ã€‚

### 1.2 å¤§å› å­æ•°ç”¨ä¾‹ï¼ˆ7000x å·®è·ï¼‰

| ç”¨ä¾‹ | CLPoly | FLINTï¼ˆä¼°è®¡ï¼‰ | æ¯”ç‡ |
|------|--------|-------------|------|
| bivar 70 çº¿æ€§å› å­ï¼ˆdeg70ï¼‰ | **65,263ms** | ~9ms | **~7000x** |
| trivar 60 çº¿æ€§å› å­ï¼ˆdeg60ï¼‰ | **5,891ms** | ~1.3ms | **~4500x** |

`bivar 70 factors = âˆ_{i=1}^{35}(x+iy)(x-iy)`ï¼šåº¦æ•° 70ï¼Œ**ä»… 36 é¡¹**ï¼ˆæç¨€ç–ï¼‰ï¼Œä½† 70 ä¸ªçº¿æ€§å› å­ã€‚

**æ ¸å¿ƒé—®é¢˜**ï¼šå› å­æ•°ï¼ˆrï¼‰å¤§æ—¶ï¼ŒCLPoly æŒ‡æ•°çº§é€€åŒ–ï¼›FLINT ä¿æŒå¤šé¡¹å¼æ—¶é—´ã€‚

---

## 2. æ ¹å› åˆ†æ

### 2.1 CLPoly å½“å‰ç®¡çº¿ï¼ˆWang EEZ + Zassenhausï¼‰

```
factorize(f âˆˆ Z[xâ‚,...,xâ‚™])
  â†’ squarefreefactorize
  â†’ __wang_core(g)
        â”œâ”€ __select_eval_point      é€‰éšæœºæ±‚å€¼ç‚¹ Î±ï¼ˆÎ±â‚‚,...,Î±â‚™ï¼‰
        â”œâ”€ factorize(g|_{xâ‚‚=Î±â‚‚,...})  å•å˜é‡å› å¼åˆ†è§£ï¼Œå¾— r ä¸ªæ¨¡å› å­ vâ‚,...,váµ£
        â”œâ”€ __wang_leading_coeff     LC åˆ†é…
        â”œâ”€ __multivar_hensel_lift   å¤šå˜é‡ Hensel æå‡ vâ‚,...,váµ£ â†’ Gâ‚,...,Gáµ£
        â”‚       â””â”€ __hensel_lift_one_var Ã— (n-1) ä¸ªæå‡å˜é‡
        â”‚               â””â”€ __multivar_diophantine Ã— deg(f, xâ‚–) æ¬¡
        â””â”€ Zassenhaus å­é›†æšä¸¾é‡ç»„  O(2^r) æœ€åæƒ…å½¢
```

### 2.2 æ ¹å›  Aï¼šBÃ©zout é“¾ç³»æ•°çˆ†ç‚¸ï¼ˆä¸»è¦ç“¶é¢ˆï¼‰

**ä½ç½®**ï¼š`__multivar_hensel_lift`ï¼Œlines 835â€“865ï¼š

```cpp
g_acc = v[0];
for (i = 1 to r-1):
    GCD(g_acc, v[i], alpha, beta);   // alpha: å¸¸æ•°ï¼Œbeta: åº¦ i-1
    for (j = 0 to i-1):
        bezout_s[j] = bezout_s[j] * beta;  // ğŸ”´ ç´¯ç§¯ä¹˜æ³•
    bezout_s[i] = denom * alpha;
    g_acc = g_acc * v[i];
```

**é—®é¢˜**ï¼šå¯¹ r ä¸ªå› å­æ„å»º BÃ©zout é“¾ï¼ˆâˆ‘ sáµ¢Â·VÌ‚áµ¢ = denomï¼ŒVÌ‚áµ¢ = âˆ_{jâ‰ i} vâ±¼ï¼‰ï¼Œåœ¨ Z[x] ä¸Šï¼ˆé Z_p[x]ï¼‰æœ‰ç¾éš¾æ€§çš„ç³»æ•°å¢é•¿ï¼š

| é‡ | r=2 | r=10 | r=70 |
|----|-----|------|------|
| bezout_s[0] çš„æ¬¡æ•° | 0 | 0+1+...+8=36 | 0+1+...+68=**2346** |
| denom çš„ä½æ•°ï¼ˆä¼°ç®—ï¼‰ | O(1) | O(10 log 10)â‰ˆ50 bit | O(70 Ã— log 70!)â‰ˆ**6000+ bit** |

> **denom çš„å¤§å°**ï¼šå¯¹äºçº¿æ€§å› å­ váµ¢ = x+káµ¢ï¼ˆkáµ¢ âˆˆ {1,...,35}ï¼‰ï¼ŒBÃ©zout é“¾çš„ denom æœ¬è´¨ä¸Šæ˜¯ Vandermonde è¡Œåˆ—å¼ V = âˆ_{i<j}(kâ±¼-káµ¢)ã€‚
> logâ‚‚(V) = âˆ‘_{d=1}^{69} (70-d)Â·logâ‚‚(d) â‰ˆ **6000 bits**ï¼ˆçº¦ 1800 ä½åè¿›åˆ¶æ•°ï¼‰ã€‚

**ç›´æ¥ä»£ä»·**ï¼š`__multivar_diophantine` åŸºæœ¬æƒ…å½¢ï¼ˆline 499ï¼‰ä¸­ï¼š

```cpp
auto si_h = bezout_s[i] * h_upoly;  // degree-2346, 6000-bit coefficients Ã— polynomial
upoly_prem(rem_upoly, si_h, v_factors[i], main_var);  // pseudo-division: 2346 bignum ops
```

- æ¯æ¬¡ Diophantine è°ƒç”¨ï¼š70 Ã— (2346 bignum ä¹˜æ³• Ã— 6000-bit æ•´æ•°) = **~1äº¿æ¬¡æœºå™¨æ“ä½œ**
- bivar-70 å…±éœ€çº¦ 2 æ¬¡è°ƒç”¨ï¼ˆj=1..2 Taylor é˜¶ï¼‰
- æ€»è®¡ï¼šçº¦ **2 äº¿æ¬¡å¤§æ•´æ•°æ“ä½œ** â†’ æ•°åç§’å®Œå…¨åˆç†

**å¯¹æ¯”**ï¼šFLINT åœ¨ Z_p[x] ä¸Šå·¥ä½œï¼Œç³»æ•°æœ‰ç•Œï¼ˆ< pï¼‰ï¼Œæ— ç³»æ•°çˆ†ç‚¸ã€‚

### 2.3 æ ¹å›  Bï¼šZassenhaus O(2^r) é‡ç»„ï¼ˆæ¬¡è¦ç“¶é¢ˆï¼‰

**ä½ç½®**ï¼š`__wang_core`ï¼Œlines 1175â€“1222ï¼Œæšä¸¾æ‰€æœ‰ C(r, s) ä¸ªå­é›†ã€‚

å¯¹ bivar-70ï¼ˆæ¯ä¸ª Hensel å› å­æ°å¥½å¯¹åº”ä¸€ä¸ªçœŸå› å­ï¼‰ï¼Œs=1 å³å…¨éƒ¨æ‰¾åˆ°ï¼Œ**Zassenhaus é€€åŒ–ä¸º O(r) è€Œé O(2^r)**ã€‚æ‰€ä»¥å¯¹æ­¤ç‰¹å®šç”¨ä¾‹ï¼ŒZassenhaus ä¸æ˜¯ä¸»å› ã€‚

ä½†å¯¹ä¸€èˆ¬å¤šå› å­å¤šå˜é‡å¤šé¡¹å¼ï¼šè‹¥çœŸå› å­æ˜¯æ¨¡å› å­çš„å¤æ‚ç»„åˆï¼ˆs > 1 æ—¶ r è¾ƒå¤§ï¼‰ï¼ŒZassenhaus ä¼šæˆä¸ºä¸»è¦ç“¶é¢ˆã€‚

### 2.4 æ ¹å›  Cï¼šç®—æ³•é€‰æ‹©ä¸åŒ¹é…ï¼ˆæ¶æ„çº§é—®é¢˜ï¼‰

bivar-70 = âˆ(x+iy)(x-iy) æ˜¯**æç¨€ç–**å¤šé¡¹å¼ï¼ˆ36 é¡¹ / 71Ã—71=5041 ä¸ªå•é¡¹å¼æ ¼ç‚¹ = **0.7% å¯†åº¦**ï¼‰ã€‚

- CLPolyï¼šæ— è®ºç¨€ç–/ç¨ å¯†ï¼Œä¸€å¾‹èµ° Wang EEZï¼ˆç¨ å¯† Hensel + Zassenhausï¼‰
- FLINTï¼šæ£€æµ‹å¯†åº¦ï¼Œ**ç¨€ç–æ—¶èµ° Zippel æ’å€¼**ï¼Œå®Œå…¨ç»•å¼€ Hensel æå‡

Zippel ç®—æ³•å¯¹ç¨€ç–è¾“å…¥ï¼šå¤æ‚åº¦ O(rÂ·TÂ²Â·nÂ·d)ï¼Œå…¶ä¸­ T=æœ€å¤§å› å­é¡¹æ•°ã€‚å¯¹ bivar-70ï¼ˆæ¯ä¸ªå› å­ 2 é¡¹ï¼šT=2ï¼‰ï¼Œå¤æ‚åº¦ O(70Ã—4Ã—1Ã—1) = O(280) ä¸ªæ±‚å€¼/æ’å€¼æ“ä½œ â†’ æ¯«ç§’çº§ã€‚

---

## 3. å‚è€ƒå®ç°åˆ†æ

### 3.1 FLINT `fmpz_mpoly_factor`

FLINT çš„å¤šå˜é‡å› å¼åˆ†è§£è°ƒåº¦ç­–ç•¥ï¼ˆ`fmpz_mpoly_factor.c`ï¼‰ï¼š

```
fmpz_mpoly_factor(f):
  è‹¥ f æ˜¯ç¨€ç–ï¼ˆdensity < thresholdï¼‰ï¼š
    â†’ factor_zippel(f)       â† Zippel ç¨€ç–æ’å€¼ï¼Œåœ¨ F_p ä¸Šå·¥ä½œ
  å¦åˆ™ï¼š
    â†’ factor_zassenhaus(f)   â† Wang + æ¨¡ Hensel + Zassenhaus
```

**factor_zippel æ ¸å¿ƒæ€è·¯**ï¼ˆ`factor_zippel.c`ï¼‰ï¼š
1. é€‰éšæœºç´ æ•° pï¼Œåœ¨ F_p[xâ‚,...,xâ‚™] ä¸­å› å¼åˆ†è§£
2. é€šè¿‡å¤šç»„æ±‚å€¼ç‚¹æ„é€  Vandermonde æ’å€¼ç³»ç»Ÿ
3. å¯¹æ¯ä¸ªå› å­çš„æ¯ä¸ªç³»æ•°åšç¨€ç–æ’å€¼ï¼ˆProny/Ben-Or-Tiwariï¼‰
4. åœ¨ Z ä¸Šç”¨ CRT + æœ‰ç†æ•°é‡å»ºæ¢å¤çœŸå› å­
5. å…¨ç¨‹æ—  Hensel æå‡ã€æ—  BÃ©zout é“¾ã€æ—  Zassenhaus é‡ç»„

**factor_zassenhaus æ ¸å¿ƒæ”¹è¿›**ï¼ˆvs CLPolyï¼‰ï¼š
- BÃ©zout é“¾åœ¨ F_{p^a}[x] ä¸Šæ„å»ºï¼ˆé Z[x]ï¼‰ï¼Œç³»æ•°æœ‰ç•Œ
- Zassenhaus é‡ç»„ç»“åˆ van Hoeij æ€è·¯ï¼ˆå½“ r å¤§æ—¶åˆ‡æ¢ï¼‰

### 3.2 Maple 2019 åŒæ¡†æ¶

Maple 2019 çš„å¤šå˜é‡å› å¼åˆ†è§£ï¼ˆMonagan-Tuncer 2019 ISSACï¼‰æ˜¯**åŒè·¯å¾„æ¡†æ¶**ï¼Œä¸¤æ¡è·¯å¾„å…±äº«åŒä¸€ä¸ªå‰ç½®æ­¥éª¤ï¼š

```
Maple factor(f âˆˆ Z[xâ‚,...,xâ‚™]):

  ã€å…³é”®å·®å¼‚ï¼šåŒå˜é‡åŸºåº•ï¼ˆbivariate baseï¼‰ã€‘
  ä¸ç›´æ¥è¯„ä¼°åˆ°å•å˜é‡ï¼Œè€Œæ˜¯ä¿ç•™ä¸€ä¸ªå˜é‡ï¼Œè¯„ä¼°åˆ°åŒå˜é‡åƒï¼š
    f_bi = f(xâ‚, xâ‚‚, Î±â‚ƒ,...,Î±â‚™) âˆˆ Z[xâ‚, xâ‚‚]
  åœ¨ Z_p[xâ‚,xâ‚‚] ä¸ŠåšåŒå˜é‡å› å¼åˆ†è§£ï¼ˆMonagan 2019 çº¿æ€§ Henselï¼‰
  â†’ åŒå˜é‡å› å­ wâ‚,...,wáµ£ âˆˆ Z_p[xâ‚,xâ‚‚]

  è·¯å¾„é€‰æ‹©ï¼ˆæŒ‰å¯†åº¦åˆ†æµï¼‰ï¼š
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚       ç¨ å¯†è·¯å¾„ï¼ˆDenseï¼‰       â”‚   â”‚       ç¨€ç–è·¯å¾„ï¼ˆSparse/MTSHLï¼‰   â”‚
  â”‚ é€å˜é‡ Wang Hensel æå‡      â”‚   â”‚ Zippel æ’å€¼æ¢å¤ xâ‚ƒ,...,xâ‚™ æ–¹å‘  â”‚
  â”‚ æ¨¡ Diophantineï¼ˆæ— ç³»æ•°çˆ†ç‚¸ï¼‰  â”‚   â”‚ å…¨ç¨‹ F_pï¼Œæ—  Henselï¼Œæ—  BÃ©zout   â”‚
  â”‚ Zassenhaus s=1 é‡ç»„          â”‚   â”‚ æ’å€¼ç›´æ¥ç»™å‡ºçœŸå› å­ï¼Œæ— éœ€é‡ç»„      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŒå˜é‡åŸºåº•çš„å…³é”®ä½œç”¨**ï¼š
- åŒå˜é‡åƒæ¯”å•å˜é‡åƒä¿ç•™æ›´å¤šå› å­ç»“æ„ä¿¡æ¯
- å¥½çš„æ±‚å€¼ç‚¹ï¼ˆÎ±â‚ƒ,...,Î±â‚™ï¼‰ä½¿åŒå˜é‡å› å­ä¸ªæ•° = çœŸå› å­ä¸ªæ•°
- ä»è€Œä¿è¯ä¸¤æ¡è·¯å¾„çš„ Zassenhaus å‡åœ¨ s=1 å±‚æˆåŠŸï¼ˆæ— æŒ‡æ•°ç»„åˆï¼‰

**CLPoly ä¸ Maple çš„åŸºåº•å·®å¼‚**ï¼š

| | CLPolyï¼ˆå½“å‰ï¼‰ | Maple 2019 |
|--|--------------|-----------|
| åŸºåº• | **å•å˜é‡**ï¼šè¯„ä¼°æ‰€æœ‰éä¸»å˜é‡ | **åŒå˜é‡**ï¼šä¿ç•™ä¸€ä¸ªé¢å¤–å˜é‡ |
| å†…å±‚å› å¼åˆ†è§£ | `factorize(upolynomial)` | åŒå˜é‡ Z_p[xâ‚,xâ‚‚] å› å¼åˆ†è§£ |
| æå‡å˜é‡æ•° | n-1 ä¸ª | n-2 ä¸ª |
| é‡ç»„ | Zassenhausï¼ˆs=1..rï¼‰ | Zassenhaus s=1ï¼ˆæœ‰åŒå˜é‡ä¿è¯ï¼‰ |

**MTSHL å¤æ‚åº¦**ï¼ˆMonagan-Tuncer 2020, JSC 99:189-230ï¼‰ï¼š
- ç¨€ç–è·¯å¾„ï¼ˆT é¡¹ï¼‰ï¼šO(rÂ·nÂ·dÂ·TÂ²) â€” å¤šé¡¹å¼æ—¶é—´
- å½“å‰ CLPolyï¼ˆå•å˜é‡åŸºåº• + Z[x] BÃ©zoutï¼‰ï¼šBÃ©zout é“¾ O(rÂ²) æ¬¡æ•°ã€O(r log r) bit ç³»æ•° â†’ å®é™…æŒ‡æ•°é€€åŒ–

### 3.3 NTL `ZZXFactoring`

NTL ä»…æ”¯æŒå•å˜é‡å› å¼åˆ†è§£ï¼Œæ— å¤šå˜é‡å®ç°ï¼ˆæ­¤å¯¹æ¯”ä¸é€‚ç”¨ï¼‰ã€‚

---

## 4. ç®—æ³•é€‰å‹å¯¹æ¯”

| ç®—æ³• | åŸç† | å®ç°éš¾åº¦ | é€‚ç”¨åœºæ™¯ | é¢„æœŸæ”¶ç›Š |
|------|------|----------|----------|----------|
| **Zippel ç¨€ç–æ’å€¼** | F_p ä¸Šæ±‚å€¼+Vandermonde æ’å€¼ | é«˜ï¼ˆéœ€è¦ç¨€ç–æ’å€¼åŸºç¡€è®¾æ–½ï¼‰ | ç¨€ç–å¤šé¡¹å¼ï¼ˆT << d^nï¼‰ | bivar-70: ~7000x â†’ <2x |
| **æ¨¡ Diophantine ä¿®å¤** | å°† BÃ©zout é“¾ç§»åˆ° F_{p^a} | ä¸­ï¼ˆå±€éƒ¨ä¿®æ”¹ `__multivar_diophantine`ï¼‰ | æ‰€æœ‰æƒ…å½¢ | bivar-70: ~7000x â†’ ~100xï¼ˆZassenhaus s=1 ä»å¯æ¥å—ï¼‰ |
| **MTSHL** | ç¨€ç– Diophantineï¼ˆZippel in-Henselï¼‰ | é«˜ï¼ˆé‡å†™ Diophantineï¼Œéœ€åŒå˜é‡åŸºåº•ï¼‰ | ç¨€ç–å¤šé¡¹å¼ï¼Œä¿ç•™ Hensel æ¡†æ¶ | ç±»ä¼¼ Zippelï¼Œå®ç°æ›´å¤æ‚ |

**å…³é”®ç»“è®ºï¼šä¼˜å…ˆçº§æ’åº**

1. **ç³»æ•°çˆ†ç‚¸**ï¼ˆæ ¹å›  Aï¼‰å¿…é¡»ä¿®å¤ï¼Œå¦åˆ™å¤§ r æƒ…å½¢ä¸å¯ç”¨â€”â€”Phase 1 è§£å†³
2. **ç®—æ³•é€‰æ‹©**ï¼ˆæ ¹å›  Cï¼‰éœ€è¦åŠ  density-based åˆ†æµâ€”â€”Phase 2 è§£å†³
3. **Zassenhaus O(2^r)**ï¼ˆæ ¹å›  Bï¼‰å¯¹å¤§ r æ˜¯æ½œåœ¨ç“¶é¢ˆï¼Œä½† Phase 2 Zippel è·¯å¾„å¯¹ç¨€ç–è¾“å…¥ä¼šå®Œå…¨ç»•å¼€ï¼ˆéæ›¿æ¢ï¼‰ï¼Œç¨ å¯†å¤§-r åœºæ™¯æš‚ä¸å¤„ç†

---

## 5. æ¨èä¼˜åŒ–è·¯çº¿

### Phase 1ï¼ˆä¼˜å…ˆï¼Œä¸­ç­‰éš¾åº¦ï¼‰ï¼šæ¨¡ BÃ©zout é“¾æ”¹é€ 

**ç›®æ ‡**ï¼šä¿®å¤ç³»æ•°çˆ†ç‚¸ï¼ŒZassenhaus é‡ç»„ä¿æŒä¸å˜ã€‚

**å…·ä½“æ”¹åŠ¨**ï¼š

```
P2a: __multivar_hensel_lift æ”¹ä¸ºæ¨¡æå‡
  - BÃ©zout é“¾åœ¨ F_{p^a}[x] ä¸Šæ„å»ºï¼ˆç±»ä¼¼å•å˜é‡ __hensel_lift çš„ p-adic è·¯çº¿ï¼‰
  - __multivar_diophantine æ”¹ç”¨æ¨¡è¿ç®—ï¼ˆå·²æœ‰ pa å‚æ•°æ”¯æŒï¼ï¼‰
  - Zassenhaus é‡ç»„ä¿æŒä¸å˜ï¼ˆbivar-70 ä¸­ s=1ï¼Œä¸æ„æˆç“¶é¢ˆï¼‰
```

**è¯´æ˜**ï¼švan Hoeij LLL çš„ CLD æ–¹æ³•æ˜¯å•å˜é‡ä¸“æœ‰çš„ï¼ˆCLD = f'/f åªåœ¨å•å˜é‡æƒ…å½¢ä¸‹å®šä¹‰ï¼‰ï¼Œ
æ²¡æœ‰æ–‡çŒ®æå‡ºå°†å…¶ç›´æ¥æ¨å¹¿åˆ° Z[xâ‚,...,xâ‚™]ã€‚Maple é€šè¿‡åŒå˜é‡åŸºåº•ä¿è¯ Zassenhaus s=1 æˆåŠŸï¼Œ
è€Œéç”¨ LLL é‡ç»„ã€‚æ­¤é˜¶æ®µ Zassenhaus ä¿æŒä¸å˜ï¼›è‹¥æœªæ¥å‡ºç° s>1 çˆ†ç‚¸åœºæ™¯ï¼Œ
å¯åœ¨ç¨€ç–è·¯å¾„ï¼ˆPhase 2 Zippelï¼‰ä¸­ä¸€å¹¶è§£å†³ã€‚

**é¢„æœŸæ”¶ç›Š**ï¼š
- bivar-70: 65s â†’ <1sï¼ˆç³»æ•°çˆ†ç‚¸æ¶ˆé™¤ â†’ çº¦ 1000x æ”¹å–„ï¼›bivar-70 ä¸­ Zassenhaus s=1 è¶³çŸ£ï¼‰
- ç¨ å¯†é€šç”¨æƒ…å½¢ï¼ˆr å°ï¼‰ï¼šåŒæ¯”ä¾‹åŠ é€Ÿï¼ŒZassenhaus O(2^r) å¯¹å° r æ— å½±å“

**å·²æœ‰åŸºç¡€**ï¼š
- `pa` å‚æ•°å·²åœ¨ `__multivar_diophantine` ä¸­æ”¯æŒï¼ˆè§ lines 518-529ï¼‰ï¼Œä½†å½“å‰ä»…åœ¨ `denom â‰  Â±1` æ—¶æ¿€æ´»ï¼Œæ”¹é€ ç›®æ ‡æ˜¯ä»¤å…¶æˆä¸ºé»˜è®¤è·¯å¾„

### Phase 2ï¼ˆé•¿æœŸï¼Œé«˜éš¾åº¦ï¼‰ï¼šZippel ç¨€ç–æ’å€¼è·¯å¾„

**ç›®æ ‡**ï¼šå¯¹ç¨€ç–å¤šé¡¹å¼èµ°å®Œå…¨ä¸åŒçš„ç®—æ³•è·¯å¾„ï¼ˆç»•å¼€ Hensel æå‡ï¼‰ã€‚

**å…·ä½“æ”¹åŠ¨**ï¼š
```
æ–°å¢: __factor_zippel(f, p)   â† å…¨æ–°æ¨¡å—ï¼Œçº¦ 500-800 è¡Œ
  - ç¨€ç– Ben-Or-Tiwari/Prony æ’å€¼
  - åœ¨ F_p ä¸Šå·¥ä½œï¼ŒCRT é‡å»º
  - éœ€è¦ç¨€ç–æ’å€¼åŸºç¡€è®¾æ–½ï¼ˆç›®å‰ CLPoly æ²¡æœ‰ï¼‰

ä¿®æ”¹: __wang_core å…¥å£ï¼š
  density = num_terms / (deg_bound_x Ã— deg_bound_y Ã— ... )
  if density < THRESHOLD: __factor_zippel(f)
  else: ç°æœ‰ Wang EEZ
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- bivar-70: 65s â†’ ~å‡ msï¼ˆå®Œå…¨å¯¹æ ‡ FLINTï¼‰
- ç¨€ç–å¤šå˜é‡é€šç”¨æƒ…å½¢ï¼šO(rÂ·TÂ²Â·nÂ·d) å¤šé¡¹å¼æ—¶é—´

**å®æ–½éš¾åº¦**ï¼šé«˜â€”â€”éœ€è¦æ–°å»ºç¨€ç–æ’å€¼å­ç³»ç»Ÿï¼Œä¸ç°æœ‰ä»£ç å‡ ä¹å®Œå…¨ç‹¬ç«‹ã€‚

---

## 6. å„é˜¶æ®µæ€§èƒ½é¢„æµ‹

| ä¼˜åŒ– | bivar-70 | trivar-60 | bivar deg5*deg5 |
|------|----------|-----------|-----------------|
| å½“å‰ | 65s | 5.9s | 0.83ms |
| Phase 1ï¼ˆæ¨¡ BÃ©zoutï¼‰ | <1s | <0.5s | ~0.4ms |
| Phase 2ï¼ˆZippel è·¯å¾„ï¼‰ | ~5ms | ~5ms | ~0.4ms |
| FLINTï¼ˆå‚è€ƒï¼‰ | ~9ms | ~1.3ms | ~0.33ms |

> **æ³¨**ï¼šPhase 1 çš„ä¼°ç®—åŸºäºï¼šæ¶ˆé™¤ 6000-bit bignum è¿ç®—åï¼ŒBÃ©zout é“¾åœ¨ F_p ä¸Šçº¦ 64-bit è¿ç®—ï¼Œå‡å°‘çº¦ 1000xï¼›åŠ ä¹‹åªæœ‰çº¦ 2 æ¬¡ Diophantine è°ƒç”¨ã€‚Phase 2 çš„ä¼°ç®—åŸºäº FLINT Zippel å®æµ‹æ•°æ®ç±»æ¯”ã€‚

---

## 7. æ¨èå®æ–½é¡ºåºä¸å…³é”®å†³ç­–

### å†³ç­– 1ï¼šPhase 1 æ˜¯å¦å€¼å¾—åšï¼Ÿ

**æ˜¯**ã€‚Phase 1ï¼ˆæ¨¡ BÃ©zout é“¾ï¼‰æ”¹åŠ¨å±€éƒ¨ï¼ˆä¸»è¦åœ¨ `__multivar_diophantine` å’Œ BÃ©zout é“¾æ„å»ºï¼‰ï¼Œé£é™©ä½ï¼Œæ”¶ç›Šå·¨å¤§ï¼šbivar-70 ä» 65s é™è‡³ <1sã€‚ç›¸æ¯” Phase 2ï¼ˆå®Œå…¨é‡å†™ï¼‰ï¼Œæ€§ä»·æ¯”æé«˜ã€‚

### å†³ç­– 2ï¼šåŒå˜é‡åŸºåº•æ˜¯å¦è¦åšï¼Ÿ

**æš‚ç¼“ï¼ˆPhase 2 ä¹‹åè¯„ä¼°ï¼‰**ã€‚

CLPoly å½“å‰ä½¿ç”¨**å•å˜é‡åŸºåº•**ï¼š`assign(g, eval)` å°†æ‰€æœ‰éä¸»å˜é‡ä»£å…¥ï¼Œå¾—åˆ°å•å˜é‡ fâ‚€ å†åšå•å˜é‡å› å¼åˆ†è§£ã€‚Maple ä½¿ç”¨**åŒå˜é‡åŸºåº•**ï¼šä¿ç•™ä¸€ä¸ªé¢å¤–å˜é‡ï¼Œå¾—åˆ°åŒå˜é‡åƒ f_bi âˆˆ Z_p[xâ‚,xâ‚‚]ï¼Œåœ¨åŒå˜é‡ä¸Šåšå†…å±‚å› å¼åˆ†è§£ã€‚

åŒå˜é‡åŸºåº•çš„ä¼˜åŠ¿ï¼šä¿è¯å¥½æ±‚å€¼ç‚¹ä¸‹åŒå˜é‡å› å­æ•° = çœŸå› å­æ•°ï¼Œä»è€Œ Zassenhaus s=1 ä¸€å®šæˆåŠŸï¼ˆæ— æŒ‡æ•°é‡ç»„ï¼‰ã€‚è¿™æ˜¯ Maple MTSHL ç¨ å¯†è·¯å¾„çš„åŸºç¡€ã€‚

ä½†æˆ‘ä»¬çš„ Phase 1 å’Œ Phase 2 å‡æ— éœ€åŒå˜é‡åŸºåº•ï¼š
- **Phase 1**ï¼ˆæ¨¡ BÃ©zoutï¼‰ï¼šåœ¨å½“å‰å•å˜é‡åŸºåº•ä¸‹å³å¯å·¥ä½œ
- **Phase 2**ï¼ˆZippel è·¯å¾„ï¼‰ï¼šä»¿ FLINTï¼Œå…¨ç¨‹åœ¨ F_p ä¸Šé€šè¿‡ç‚¹å€¼+æ’å€¼é‡å»ºå› å­ï¼Œå®Œå…¨ç»•å¼€ Hensel æå‡ï¼Œä¹Ÿä¸ä¾èµ–åŒå˜é‡åŸºåº•

åŒå˜é‡åŸºåº•ä»…åœ¨å®ç°å®Œæ•´ Maple MTSHL ç¨ å¯†è·¯å¾„æ—¶æ‰éœ€è¦ï¼Œåˆ—ä¸º**æœªæ¥å·¥ä½œ**ã€‚

### å†³ç­– 3ï¼šZippel æ˜¯å¦ç°åœ¨åšï¼Ÿ

**æš‚ç¼“**ã€‚å®ç°éš¾åº¦é«˜ï¼ˆ~500-800 è¡Œæ–°ä»£ç  + ç¨€ç–æ’å€¼å­ç³»ç»Ÿï¼‰ï¼Œä¸” Phase 1 å·²èƒ½è§£å†³å¤§éƒ¨åˆ†ç“¶é¢ˆã€‚Zippel çš„ä¼˜åŠ¿åœ¨äºè¶…ç¨€ç–æƒ…å½¢ï¼ˆT << d^nï¼‰ï¼ŒPhase 1 å·²å°† bivar-70 é™è‡³å¯æ¥å—èŒƒå›´ã€‚å¯åœ¨ Phase 1 ç¨³å®šåï¼Œé€šè¿‡ profiling ç¡®è®¤å‰©ä½™å·®è·åå†å†³å®šæ˜¯å¦æ¨è¿›ã€‚

### å†³ç­– 4ï¼šMTSHL ä¸ Phase 1 çš„å…³ç³»

MTSHL æœ¬è´¨ä¸Šæ˜¯æ¨¡ BÃ©zoutï¼ˆPhase 1ï¼‰+ Zippel Diophantineï¼ˆPhase 2ï¼‰çš„ç»„åˆâ€”â€”Hensel æ¡†æ¶ä¿ç•™ï¼Œä½† Diophantine æ±‚è§£å™¨æ¢æˆ Zippel ç¨€ç–æ’å€¼ã€‚Phase 1 å…ˆå®ç°ç®€åŒ–çš„æ¨¡ BÃ©zoutï¼›MTSHL å®Œæ•´å®ç°æ˜¯ Phase 1 + Phase 2 çš„äº¤ç»‡ï¼Œå¹¶é¢å¤–éœ€è¦åŒå˜é‡åŸºåº•ã€‚å¯å°† Phase 1 è§†ä¸ºé€šå¾€ MTSHL çš„ç¬¬ä¸€æ­¥ã€‚

---

## 8. å…³é”®å‚è€ƒæ–‡çŒ®

| æ–‡çŒ® | è§’è‰² |
|------|------|
| Wang (1978). *EUROSAM '78*:137â€“151 | Wang EEZ ç®—æ³•ï¼ˆCLPoly å½“å‰å®ç°åŸºç¡€ï¼‰ |
| Zippel (1979). *EUROSAM '79*:216â€“226 | ç¨€ç–æ’å€¼ç®—æ³•ï¼ˆFLINT ä¸»è·¯å¾„ï¼‰ |
| Zippel (1993). *Effective Polynomial Computation* Â§7 | Zippel ç®—æ³•å®Œæ•´æè¿° |
| Monagan & Tuncer (2016). *CASC 2016*, LNCS 9890:171â€“186 | MTSHL æ ¸å¿ƒç®—æ³• |
| Monagan & Tuncer (2018). *ICMS 2018*, LNCS 10931:378â€“387 | MTSHL å®ç°ï¼ˆMaple é‡‡ç”¨ç‰ˆæœ¬ï¼‰ |
| Monagan & Tuncer (2019). *ISSAC 2019* | Maple 2019 ç®—æ³•å…¨è²Œ |
| Monagan & Tuncer (2020). *J. Symbolic Comput.* 99:189â€“230 | MTSHL å¤æ‚åº¦è¯æ˜ |
| GCL Â§6.3â€“Â§6.7 | å¤šå˜é‡ Hensel æå‡ä¸ Diophantineï¼ˆå½“å‰å®ç°å‚è€ƒï¼‰ |

---

## 9. ç»“è®º

CLPoly å¤šå˜é‡å› å¼åˆ†è§£ 7000x å·®è·çš„**ä¸»è¦æ ¹å› **æ˜¯ï¼š

1. **BÃ©zout é“¾ç³»æ•°çˆ†ç‚¸**ï¼ˆæ ¹å›  Aï¼Œå  ~99% çš„æ—¶é—´ï¼‰ï¼šåœ¨ Z[x] ä¸Šä¸º r ä¸ªå› å­æ„å»º BÃ©zout é“¾ï¼Œbezout_s[0] çš„æ¬¡æ•°è¾¾ O(rÂ²)ï¼Œç³»æ•°ä½æ•°è¾¾ O(r log r)ï¼Œå¯¼è‡´ Diophantine åŸºæœ¬æƒ…å½¢æ¯æ¬¡è°ƒç”¨æ‰§è¡Œäº¿æ¬¡å¤§æ•´æ•°æ“ä½œã€‚**ä¿®å¤**ï¼šå°† BÃ©zout é“¾å’Œ Diophantine ç§»è‡³ F_{p^a}ï¼ˆå·²æœ‰ `pa` å‚æ•°éª¨æ¶ï¼‰ã€‚

2. **ç®—æ³•é€‰æ‹©ä¸åŒ¹é…**ï¼ˆæ ¹å›  Cï¼‰ï¼šå¯¹ç¨€ç–è¾“å…¥ï¼ˆbivar-70 å¯†åº¦ 0.7%ï¼‰ï¼ŒCLPoly ä»èµ°ç¨ å¯† Wang EEZï¼ŒFLINT èµ° Zippel ç¨€ç–æ’å€¼ã€‚**ä¿®å¤**ï¼šPhase 2 å®ç° Zippel + å¯†åº¦åˆ†æµã€‚

**ä¸‹ä¸€æ­¥**ï¼šæ¶æ„æ–‡æ¡£å·²å®Œæˆï¼ˆ`docs/design/multivar-opt/architecture.md`ï¼‰ï¼ŒæŒ‰ workflow è¿›å…¥ç»†åŒ– â†’ å®æ–½é˜¶æ®µï¼Œä» Phase 1 M1ï¼ˆæ¨¡ BÃ©zout é“¾ï¼‰å¼€å§‹ã€‚
